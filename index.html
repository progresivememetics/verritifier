<html>
 <head> 
 <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow">
 <script>
 function refresh() {
	location.reload();
 }
 
 function clearAll() {
	document.getElementById("line1").value = "";
	document.getElementById("line2").value = "";
	document.getElementById("line3").value = "";
	document.getElementById("line4").value = "";
	document.getElementById("line5").value = "";
	document.getElementById("source").value = "";
}
 window.onload = function() {
  document.getElementById("again").style.visibility = "hidden";

};
document.fonts.ready.then(function () { 
	document.getElementById("verritButton").innerHTML = "Verritify!";
	document.getElementById("verritButton").disabled = false;
});

 
 var form = document.getElementById("veritForm"); 
 function handleForm(event) { event.preventDefault(); } form.addEventListener('submit', handleForm);
 function verritify(){
 
   document.getElementById("again").style.visibility = "visible";
      document.getElementById("verritButton").style.visibility = "hidden";
	  
      document.getElementById("clear").style.visibility = "hidden";


 var canvas = document.getElementById("myCanvas");
 var context = canvas.getContext("2d");
 context.clearRect(0, 0, canvas.width, canvas.height);
 var imageObj = new Image();
 var line1 = document.getElementById("line1").value;
  var line2 = document.getElementById("line2").value;
  var line3 = document.getElementById("line3").value;
  
  var line4 = document.getElementById("line4").value;
  var line5 = document.getElementById("line5").value;
  
  var source = document.getElementById("source").value;
  
  var number = Math.floor(Math.random()*10000000);
  var idText = "";
  var digits = Math.ceil(Math.log10(number));
  var leadingZeroes = 7 - digits;
  while(leadingZeroes > 0) {
	idText += "0";
	leadingZeroes--;
  }
  idText += number;

 //imageObj.src = "https://i.imgur.com/vKf3NgP.jpg"; 
 imageObj.src = "https://i.imgur.com/fzrXind.jpg";
 imageObj.onload = function(){
     context.font = "bold 28px PT Sans Narrow";
     context.drawImage(imageObj, 0, 0);
	 context.fillText(""+idText, 490,542);
	 context.fillStyle = "#232323";
	 
	 context.font = "bold 50px PT Sans Narrow";
	 context.save();
     context.fillText(line1, 150, 200);
	 context.save();
	 context.fillText(line2, 150, 250);
	 context.save();
	 context.fillText(line3, 150, 300);
	  context.save();
	 context.fillText(line4, 150, 350);
	  context.save();
	 context.fillText(line5, 150, 400);
	 context.translate(600,300)
	context.save();
	context.rotate(-Math.PI/2);
	context.save();
		context.translate(-600,-300)
	context.font = "bold 30px PT Sans Narrow";
	context.fillText(source, 350, -210);
	
	context.rotate(Math.PI/2);
	context.save();
	
	

     // open the image in a new browser tab
     // the user can right-click and save that image
     //var win=window.open();
     this.document.write("<img src='"+canvas.toDataURL()+"'/>");    

 };
};
</script>
 </head>
  <body>
  
<h1 style="font-family: 'PT Sans Narrow';">IPM Verritifier 0.0.0.0.0.0.0.2</h1>
  <p>You are limited to 52 characters per line. Now get verriting! <br>
  	  Note: If the loading fonts button doesn't go away, just refresh the page.</p>
  	  	  <p>Disclaimer: This is intended for satire only. We are not affiliated in any way with Verrit or its field of corncobs, nor would we ever fucking be.</p>
<form id="veritForm"> 
  Source:<br>
  <input type="text" name="Source" id="source" size="40" maxlength="52" value="BlueShareReviewit"><br>
  Line 1:<br>
  <input type="text" name="Line 1" id="line1" size="40" maxlength="52" value="Campaigning for votes is undemocratic.">
  <br>
  Line 2:<br>
  <input type="text" name="Line 2" id="line2" size="40" maxlength="52" value="Votes are owned, not earned.">
  <br>
  Line 3:<br>
  <input type="text" name="Line 3" id="line3" size="40" maxlength="52" value=""><br>
  Line 4:<br>
  <input type="text" name="Line 4" id="line4" size="40" maxlength="52" value=""><br>
  Line 5:<br>
  <input type="text" name="Line 5" id="line5"size="40" maxlength="52" value=""><br><br>
  <button type="button"  onclick="clearAll()" id="clear"> Clear </button>
  <button type="button"  onclick="verritify()" id="verritButton" disabled> Loading Fonts... </button>
  <button type="button"  onclick="refresh()" id="again"> Click to make another one!</button>
</form> 
    <canvas id="myCanvas" width=1200 height = 600>
    </canvas>
  </body>
</html>
